<!DOCTYPE html>
<html>
<head>
  <title>Doodle Jump Clone with Jetpack</title>
  <style>
    body { margin:0; background:#87CEEB; overflow:hidden; }
    canvas { display:block; margin:0 auto; background:#87CEEB; }
  </style>
</head>
<body>
<canvas id="gameCanvas" width="400" height="600"></canvas>
<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

let gameStarted = false;
let gameOver = false;
let score = 0;
let powerJumps = 10;
let blocksPassed = 0;

// âœ… Smaller player
const player = { x:200, y:500, w:32, h:32, dy:0, onGround:false, usingJetpack:false };

let platforms = [];
let jetpacks = [];
const platformCount = 8;

const keys = { left:false, right:false, jet:false };

// --- Create platforms ---
function createPlatforms() {
  platforms.push({
    x: player.x - 35,
    y: player.y + player.h + 10,
    w: 70,
    h: 15,
    broken: false
  });

  for(let i = 1; i < platformCount; i++){
    spawnPlatform(player.y + player.h + 10 - i*75);
  }
}

function spawnPlatform(y){
  const p = {
    x: Math.random()*(canvas.width-70),
    y: y,
    w:70,
    h:15,
    broken:false
  };
  platforms.push(p);

  if(Math.random() < 0.1){
    jetpacks.push({
      x: p.x + p.w/2 - 12,
      y: p.y - 30,
      w: 24,
      h: 30,
      active: true
    });
  }
}

// --- Draw Doodle Player (UPDATED) ---
function drawDoodle(x, y, w, h){
  // Body (black)
  ctx.fillStyle = '#2E7D32';
  ctx.beginPath();
  ctx.roundRect(x, y, w, h, 8);
  ctx.fill();

  // Dot eyes
  ctx.fillStyle = 'dark green';
  ctx.beginPath();
  ctx.arc(x + w*0.35, y + h*0.35, 2.5, 0, Math.PI*2);
  ctx.arc(x + w*0.65, y + h*0.35, 2.5, 0, Math.PI*2);
  ctx.fill();

  // Oval mouth
  ctx.beginPath();
  ctx.ellipse(
    x + w/2,
    y + h*0.6,
    5,
    3,
    0,
    0,
    Math.PI * 2
  );
  ctx.fill();

  // Feet
  ctx.fillStyle = '#1B5E20';
  ctx.fillRect(x + 4, y + h - 4, 6, 4);
  ctx.fillRect(x + w - 10, y + h - 4, 6, 4);

  // Jetpack
  ctx.fillStyle = 'gray';
  ctx.fillRect(x - 4, y + 8, 4, 16);
}

// --- Game loop ---
function update(){
  if(!gameStarted) return drawStartScreen();
  if(gameOver) return drawGameOver();

  const jumpStrength = 15;
  const playerSpeed = 5;
  const jetStrength = 18;

  if(keys.jet && powerJumps > 0 && !player.usingJetpack){
    player.dy = -jetStrength;
    powerJumps--;
    player.usingJetpack = true;
  }

  if(player.onGround && !player.usingJetpack)
    player.dy = -jumpStrength;

  player.dy += 0.8;
  player.y += player.dy;

  if(keys.left) player.x -= playerSpeed;
  if(keys.right) player.x += playerSpeed;

  if(player.x + player.w < 0) player.x = canvas.width;
  if(player.x > canvas.width) player.x = -player.w;

  player.onGround = false;
  for(let p of platforms){
    if(player.x + player.w > p.x && player.x < p.x + p.w &&
       player.y + player.h > p.y && player.y + player.h < p.y + p.h + player.dy){
      player.dy = 0;
      player.y = p.y - player.h;
      player.onGround = true;
      player.usingJetpack = false;
    }
  }

  jetpacks.forEach(j => {
    if(!j.active) return;
    if(player.x < j.x + j.w &&
       player.x + player.w > j.x &&
       player.y < j.y + j.h &&
       player.y + player.h > j.y){
      player.dy = -35;
      j.active = false;
    }
  });

  if(player.y < 200){
