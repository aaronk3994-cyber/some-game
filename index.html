<!DOCTYPE html>
<html>
<head>
  <title>Power Jump</title>
  <style>
    body { margin:0; background: #87CEEB; overflow: hidden; }
    canvas { display:block; margin:0 auto; background:#87CEEB; }
  </style>
</head>
<body>
<canvas id="gameCanvas" width="400" height="600"></canvas>
<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

let gameStarted = false;
let gameOver = false;
let score = 0;

// Player
const player = { x: 200, y: 500, w: 30, h: 30, dy: 0, onGround: false };

// Platforms
const platforms = [];
const platformCount = 8;

function createPlatforms() {
  for (let i = 0; i < platformCount; i++) {
    let p = {
      x: Math.random() * (canvas.width - 70),
      y: i * 75,
      w: 70,
      h: 15,
      broken: false
    };
    platforms.push(p);
  }
}

// Controls
const keys = { left:false, right:false, jump:false };
document.addEventListener('keydown', e => {
  if(e.key === "ArrowLeft") keys.left = true;
  if(e.key === "ArrowRight") keys.right = true;
  if(e.key === "Enter") {
    if(!gameStarted) { gameStarted = true; }
    keys.jump = true;
  }
});
document.addEventListener('keyup', e => {
  if(e.key === "ArrowLeft") keys.left = false;
  if(e.key === "ArrowRight") keys.right = false;
  if(e.key === "Enter") keys.jump = false;
});

// Game Loop
function update() {
  if(!gameStarted) return drawStartScreen();
  if(gameOver) return drawGameOver();

  // Move player
  if(keys.left) player.x -= 5;
  if(keys.right) player.x += 5;

  // Jump / gravity
  if(keys.jump && player.onGround) {
    player.dy = -20; // 5x higher jump
    player.onGround = false;
  }
  player.dy += 0.8; // gravity
  player.y += player.dy;

  // Collision with platforms
  player.onGround = false;
  for(let p of platforms) {
    if(player.x + player.w > p.x && player.x < p.x + p.w &&
       player.y + player.h > p.y && player.y + player.h < p.y + p.h + player.dy) {
      player.dy = 0;
      player.y = p.y - player.h;
      player.onGround = true;

      // Break the platform randomly
      if(!p.broken && Math.random() < 0.2) {
        p.broken = true;
      }
    }
  }

  // Scroll screen
  if(player.y < 200) {
    let dy = 200 - player.y;
    player.y = 200;
    platforms.forEach(p => p.y += dy);
    score += Math.floor(dy);
  }

  // Game over
  if(player.y > canvas.height) gameOver = true;

  draw();
  requestAnimationFrame(update);
}

// Draw
function draw() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Platforms
  for(let p of platforms) {
    ctx.fillStyle = p.broken ? '#8B0000' : '#228B22';
    ctx.fillRect(p.x, p.y, p.w, p.h);
    if(p.broken) {
      // Cracks for broken platforms
      ctx.strokeStyle = 'black';
      ctx.beginPath();
      ctx.moveTo(p.x, p.y);
      ctx.lineTo(p.x + p.w, p.y + p.h);
      ctx.moveTo(p.x + p.w, p.y);
      ctx.lineTo(p.x, p.y + p.h);
      ctx.stroke();
    }
  }

  // Player
  ctx.fillStyle = 'orange';
  ctx.fillRect(player.x, player.y, player.w, player.h);

  // Jetpack effect
  if(!player.onGround) {
    ctx.fillStyle = 'yellow';
    ctx.beginPath();
    ctx.moveTo(player.x + player.w/2 - 5, player.y + player.h);
    ctx.lineTo(player.x + player.w/2 + 5, player.y + player.h);
    ctx.lineTo(player.x + player.w/2, player.y + player.h + 15);
    ctx.fill();
  }

  // Score
  ctx.fillStyle = 'black';
  ctx.font = '20px Arial';
  ctx.fillText('Score: ' + score, 10, 30);
}

// Start screen
function drawStartScreen() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle = 'black';
  ctx.font = '40px Arial';
  ctx.textAlign = 'center';
  ctx.fillText('Power Jump', canvas.width/2, 200);
  ctx.font = '20px Arial';
  ctx.fillText('Press Enter to Start', canvas.width/2, 300);
  requestAnimationFrame(update);
}

// Game over screen
function drawGameOver() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle = 'red';
  ctx.font = '40px Arial';
  ctx.textAlign = 'center';
  ctx.fillText('Game Over', canvas.width/2, 250);
  ctx.font = '20px Arial';
  ctx.fillText('Score: ' + score, canvas.width/2, 300);
  ctx.fillText('Refresh to Play Again', canvas.width/2, 350);
}

createPlatforms();
update();
</script>
</body>
</html>
