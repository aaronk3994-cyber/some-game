<!DOCTYPE html>
<html>
<head>
  <title>Doodle Jump Jetpack Clone</title>
  <style>
    body { margin:0; overflow:hidden; }
    canvas { display:block; margin:0 auto; background:white; }
  </style>
</head>
<body>
<canvas id="gameCanvas" width="400" height="600"></canvas>
<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

let gameStarted = false;
let gameOver = false;
let score = 0;
let powerJumps = 5; 
let blocksPassed = 0;

// --- Player setup ---
const player = { 
  x: 200, 
  y: 500, 
  w: 35,  
  h: 35,  
  dy: 0, 
  onGround: false,
  jetActive: false,
  jetTime: 0
};

let platforms = [];
let jetpacks = [];
const platformCount = 8;
const keys = { left:false, right:false, jet:false };

// --- Platforms ---
function createPlatforms() {
  // First platform directly under player
  platforms.push({ 
    x: player.x - 35,            
    y: player.y + player.h,      
    w: 70, 
    h: 15, 
    type: 'normal', 
    dir: 0, 
    speed: 0
  });

  // Create rest of platforms above
  for(let i = 1; i < platformCount; i++){
    spawnPlatform(player.y + player.h + 10 - i*75);
  }
}

function spawnPlatform(y){
  const moving = Math.random() < 0.2;
  const p = { 
    x: Math.random()*(canvas.width-70), 
    y: y, 
    w:70, 
    h:15, 
    type: 'normal', 
    dir: moving ? 1 : 0,
    speed: moving ? 2 + Math.random()*2 : 0
  };
  platforms.push(p);

  if(Math.random() < 0.15){
    jetpacks.push({ 
      x: p.x + p.w/2 - 12, 
      y: p.y - 30, 
      w: 24, 
      h: 30, 
      active: true, 
      timeLeft: 4000 // 4-second jetpack boost
    });
  }
}

// --- Draw player ---
function drawDoodle(x, y, w, h){
  ctx.fillStyle = '#006400';
  ctx.beginPath();
  ctx.roundRect(x, y, w, h, 8);
  ctx.fill();

  ctx.fillStyle = 'black';
  ctx.beginPath();
  ctx.arc(x + w*0.3, y + h*0.3, 2, 0, Math.PI*2);
  ctx.arc(x + w*0.7, y + h*0.3, 2, 0, Math.PI*2);
  ctx.fill();

  ctx.strokeStyle = 'black';
  ctx.lineWidth = 2;
  ctx.beginPath();
  ctx.moveTo(x + w*0.4, y + h*0.65);
  ctx.lineTo(x + w*0.6, y + h*0.65);
  ctx.stroke();

  ctx.fillStyle = '#2E8B57';
  ctx.fillRect(x + 5, y + h - 4, 8, 5);
  ctx.fillRect(x + w - 13, y + h - 4, 8, 5);

  ctx.fillStyle = 'gray';
  ctx.fillRect(x - 5, y + 8, 5, 15);
}

// --- Game loop ---
let lastTime = performance.now();

function update(time = performance.now
